# Amazonã‹ã‚‰æ…¶æ‡‰ç¾©å¡¾å¤§å­¦å›³æ›¸é¤¨ã‚’æ¤œç´¢ ğŸ“š

Amazon.co.jpã®å•†å“ãƒšãƒ¼ã‚¸ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹è£½å“ã‚’ã€æ…¶æ‡‰ç¾©å¡¾å¤§å­¦ã®è”µæ›¸ç›®éŒ²ã‹ã‚‰ç´ æ—©ãæ¤œç´¢ã™ã‚‹ãŸã‚ã®ã‚·ãƒ³ãƒ—ãƒ«ãªChromeæ‹¡å¼µæ©Ÿèƒ½ã§ã™ã€‚

## ç‰¹å¾´ âœ¨

- **ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯æ¤œç´¢**: ğŸ–±ï¸ æ‹¡å¼µæ©Ÿèƒ½ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã ã‘ã§ã€è¡¨ç¤ºä¸­ã®Amazonå•†å“ã‚’å³åº§ã«æ¤œç´¢ã—ã¾ã™ã€‚
- **åŸ‹ã‚è¾¼ã¿è¡¨ç¤º**: ğŸ“– æ…¶æ‡‰ç¾©å¡¾å¤§å­¦å›³æ›¸é¤¨ã®æ¤œç´¢çµæœã‚’ã€æ‹¡å¼µæ©Ÿèƒ½ã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†…ã«ç›´æ¥è¡¨ç¤ºã—ã¾ã™ã€‚
- **ã‚¿ã‚¤ãƒˆãƒ«ã®è‡ªå‹•æŠ½å‡º**: ğŸ” è¡¨ç¤ºä¸­ã®Amazonãƒšãƒ¼ã‚¸ã‹ã‚‰è£½å“ã‚¿ã‚¤ãƒˆãƒ«ã‚’è‡ªå‹•çš„ã«æ¤œå‡ºãƒ»æŠ½å‡ºã—ã¾ã™ã€‚
- **ã‚¿ã‚¤ãƒˆãƒ«ã®è‡ªå‹•æ•´å½¢**: ğŸ§¹ æ¤œç´¢ç²¾åº¦ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã€ã‚¿ã‚¤ãƒˆãƒ«ã®ä¸è¦ãªéƒ¨åˆ†ï¼ˆä¾‹: `(å²©æ³¢æ›¸åº—)`ã®ã‚ˆã†ãªæ‹¬å¼§å†…ã®ãƒ†ã‚­ã‚¹ãƒˆï¼‰ã‚’è‡ªå‹•çš„ã«å‰Šé™¤ã—ã¾ã™ã€‚

## ä»•çµ„ã¿ âš™ï¸

Amazon.co.jpã®å•†å“ãƒšãƒ¼ã‚¸ã‚’é–‹ã„ã¦ã„ã‚‹ã¨ãã«ã€Chromeã®ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã«ã‚ã‚‹æ‹¡å¼µæ©Ÿèƒ½ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã ã‘ã§ã™ã€‚æ‹¡å¼µæ©Ÿèƒ½ãŒå•†å“ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å–å¾—ã—ã€æ¤œç´¢ã‚¯ã‚¨ãƒªã‚’çµ„ã¿ç«‹ã¦ã€ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—å†…ã§æ…¶æ‡‰ç¾©å¡¾å¤§å­¦å›³æ›¸é¤¨ã®æ¤œç´¢çµæœã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³• â¬‡ï¸

ã“ã®æ‹¡å¼µæ©Ÿèƒ½ã¯Chromeã‚¦ã‚§ãƒ–ã‚¹ãƒˆã‚¢ã§å…¬é–‹ã•ã‚Œã¦ã„ãªã„ãŸã‚ã€ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ã£ã¦æ‰‹å‹•ã§èª­ã¿è¾¼ã‚€å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

1.  **ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰**: ğŸ’¾ ã™ã¹ã¦ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`manifest.json`, `popup.html`, `popup.js`, `style.css`ã¨`images`ãƒ•ã‚©ãƒ«ãƒ€ï¼‰ã‚’ã€`keio-library-search`ã®ã‚ˆã†ãªä¸€ã¤ã®ãƒ•ã‚©ãƒ«ãƒ€ã«ã¾ã¨ã‚ã¦ãã ã•ã„ã€‚
2.  **Chromeæ‹¡å¼µæ©Ÿèƒ½ãƒšãƒ¼ã‚¸ã‚’é–‹ã**: ğŸŒ Google Chromeã‚’é–‹ãã€ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒãƒ¼ã« `chrome://extensions` ã¨å…¥åŠ›ã—ã¦ç§»å‹•ã—ã¾ã™ã€‚
3.  **ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã‚’æœ‰åŠ¹åŒ–**: âš™ï¸ ãƒšãƒ¼ã‚¸ã®å³ä¸Šã«ã‚ã‚‹ã€Œ**ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ ãƒ¢ãƒ¼ãƒ‰**ã€ã®ã‚¹ã‚¤ãƒƒãƒã‚’ã‚ªãƒ³ã«ã—ã¾ã™ã€‚
4.  **æ‹¡å¼µæ©Ÿèƒ½ã®èª­ã¿è¾¼ã¿**:
    - ğŸ“¦ å·¦ä¸Šã«è¡¨ç¤ºã•ã‚Œã‚‹ã€Œ**ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã•ã‚Œã¦ã„ãªã„æ‹¡å¼µæ©Ÿèƒ½ã‚’èª­ã¿è¾¼ã‚€**ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
    - ğŸ“‚ ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã—ãŸãƒ•ã‚©ãƒ«ãƒ€ï¼ˆä¾‹: `keio-library-search`ï¼‰ã‚’é¸æŠã—ã¾ã™ã€‚
5.  **å®Œäº†**: âœ… ã“ã‚Œã§Chromeã®ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã«æ‹¡å¼µæ©Ÿèƒ½ã®ã‚¢ã‚¤ã‚³ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ãƒ‘ã‚ºãƒ«ã®ãƒ”ãƒ¼ã‚¹ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€æ‹¡å¼µæ©Ÿèƒ½ã‚’ã€Œãƒ”ãƒ³ç•™ã‚ã€ã™ã‚‹ã¨å¸¸ã«è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

## ä½¿ã„æ–¹ ğŸ’¡

1.  `www.amazon.co.jp`ã®ã„ãšã‚Œã‹ã®å•†å“ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ã¾ã™ã€‚
2.  ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã«ã‚ã‚‹ã€ŒKeio Library Searcherã€ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚
3.  ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãŒé–‹ãã€æ…¶æ‡‰ç¾©å¡¾å¤§å­¦å›³æ›¸é¤¨ã®æ¤œç´¢çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

## ä½¿ç”¨æŠ€è¡“ ğŸ› ï¸

- HTML5
- CSS3
- JavaScript (ES6+)
- Chromeæ‹¡å¼µæ©Ÿèƒ½ Manifest V3 API

---

## é–‹ç™ºè€…å‘ã‘ ğŸ§‘â€ğŸ’»

ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç†è§£ãƒ»ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãƒ»è²¢çŒ®ã—ãŸã„é–‹ç™ºè€…ã®ãŸã‚ã«ã€ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®æ¦‚è¦ã‚’èª¬æ˜ã™ã‚‹ã‚‚ã®ã§ã™ã€‚

### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ ğŸ“‚

-   `manifest.json`: æ‹¡å¼µæ©Ÿèƒ½ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã€æ¨©é™ã€å‹•ä½œã‚’å®šç¾©ã—ã¾ã™ã€‚`action.default_popup`ã¨ã—ã¦`popup.html`ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚
-   `popup.html`: ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®åŸºæœ¬çš„ãªHTMLæ§‹é€ ã§ã™ã€‚å›³æ›¸é¤¨ã®æ¤œç´¢çµæœã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®`<iframe>`è¦ç´ ã‚’å«ã¿ã€å¿…è¦ãªCSSã¨JavaScriptãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚
-   `popup.js`: ã“ã®æ‹¡å¼µæ©Ÿèƒ½ã®ä¸­æ ¸ã¨ãªã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã§ã™ã€‚ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãŒé–‹ã‹ã‚Œã‚‹ãŸã³ã«å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
-   `style.css`: ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®ã™ã¹ã¦ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å«ã¿ã¾ã™ã€‚

### ä¸­æ ¸ãƒ­ã‚¸ãƒƒã‚¯ (`popup.js`) ğŸ§ 

ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œãƒ•ãƒ­ãƒ¼ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

1.  **ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¿ãƒ–ã®å–å¾—**: `chrome.tabs.query()`ã‚’ä½¿ç”¨ã—ã¦ã€ç¾åœ¨ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¿ãƒ–ã®æƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚
2.  **ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æ³¨å…¥**: ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªã‚¿ãƒ–ãŒ`amazon.co.jp`ã®ãƒšãƒ¼ã‚¸ã‹ã‚’ç¢ºèªã—ã¾ã™ã€‚ã‚‚ã—ãã†ãªã‚‰ã€`chrome.scripting.executeScript()`ã‚’ä½¿ã„ã€ãƒšãƒ¼ã‚¸ã«`getPageTitle`é–¢æ•°ã‚’æ³¨å…¥ã—ã¾ã™ã€‚
3.  **ã‚¿ã‚¤ãƒˆãƒ«ã®æŠ½å‡º**: æ³¨å…¥ã•ã‚ŒãŸ`getPageTitle`é–¢æ•°ã¯ã€`h1#productTitle`ã¾ãŸã¯`h1#title`ã‚’æ¢ã—ã¦å•†å“ã‚¿ã‚¤ãƒˆãƒ«ã‚’è¦‹ã¤ã‘ã€ãã®ãƒ†ã‚­ã‚¹ãƒˆã‚’è¿”ã—ã¾ã™ã€‚
4.  **ã‚¿ã‚¤ãƒˆãƒ«ã®æ•´å½¢**: `popup.js`ã¯ã‚¿ã‚¤ãƒˆãƒ«ã‚’å—ã‘å–ã‚‹ã¨ã€æ­£è¦è¡¨ç¾ (`.replace(/\(.*?\)/g, '')`) ã‚’ä½¿ç”¨ã—ã¦ã€æ‹¬å¼§ã§å›²ã¾ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆã‚’å‰Šé™¤ã—ã€ã‚¿ã‚¤ãƒˆãƒ«ã‚’æ•´å½¢ã—ã¾ã™ã€‚
5.  **URLã®æ§‹ç¯‰ã¨è¨­å®š**: æ•´å½¢ã•ã‚ŒãŸã‚¿ã‚¤ãƒˆãƒ«ã¯`encodeURIComponent()`ã§URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚Œã€æ…¶æ‡‰ç¾©å¡¾å¤§å­¦å›³æ›¸é¤¨ã®æ¤œç´¢URLãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«æŒ¿å…¥ã•ã‚Œã¾ã™ã€‚ã“ã®æœ€çµ‚çš„ãªURLãŒ`popup.html`ã®`<iframe>`ã®`src`å±æ€§ã¨ã—ã¦è¨­å®šã•ã‚Œã€çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

### ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º ğŸ”§

-   **æ¤œç´¢å¯¾è±¡ã®å›³æ›¸é¤¨ã‚’å¤‰æ›´ã™ã‚‹**: ã“ã®æ‹¡å¼µæ©Ÿèƒ½ã‚’åˆ¥ã®å›³æ›¸é¤¨ã«å¯¾å¿œã•ã›ã‚‹ã«ã¯ã€`popup.js`ã®å†’é ­ã«ã‚ã‚‹å®šæ•°`KEIO_SEARCH_URL_PREFIX`ã¨`KEIO_SEARCH_URL_SUFFIX`ã‚’å¤‰æ›´ã™ã‚‹ã ã‘ã§ã™ã€‚
-   **ã‚¿ã‚¤ãƒˆãƒ«ã‚»ãƒ¬ã‚¯ã‚¿ã‚’æ›´æ–°ã™ã‚‹**: AmazonãŒãƒšãƒ¼ã‚¸ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’å¤‰æ›´ã—ãŸå ´åˆã€`popup.js`å†…ã®`getPageTitle`é–¢æ•°ã«ã‚ã‚‹CSSã‚»ãƒ¬ã‚¯ã‚¿ã‚’æ›´æ–°ã—ã¦ã€æ­£ã—ãå•†å“ã‚¿ã‚¤ãƒˆãƒ«ã‚’å–å¾—ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
-   **ã‚¹ã‚¿ã‚¤ãƒ«ã®èª¿æ•´**: ğŸ¨ ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã®è¦‹ãŸç›®ã«é–¢ã™ã‚‹ã™ã¹ã¦ã®è¦ç´ ã¯`style.css`ã§å¤‰æ›´ã§ãã¾ã™ã€‚

---

# Keio Library Search from Amazon ğŸ“š

A simple Chrome extension that allows you to quickly search for a product listed on Amazon.co.jp in the Keio University Library catalog.

## Features âœ¨

- **One-Click Search**: ğŸ–±ï¸ Instantly search for the current Amazon product with a single click on the extension icon.
- **Embedded Results**: ğŸ“– View the Keio University Library search results directly within the extension's popup window.
- **Automatic Title Extraction**: ğŸ” The extension automatically detects and extracts the product title from the active Amazon page.
- **Smart Title Cleaning**: ğŸ§¹ It automatically removes extraneous text from the title (e.g., content within parentheses like `(Special Edition)`) to improve search accuracy.

## How It Works âš™ï¸

When you are on an Amazon.co.jp product page, simply click the extension's icon in your Chrome toolbar. The extension will grab the product's title, formulate a search query, and display the Keio University Library's search results page inside the popup.

## Installation â¬‡ï¸

Since this extension is not on the Chrome Web Store, you can load it manually using Developer Mode.

1.  **Download the Files**: ğŸ’¾ Make sure all the project files (`manifest.json`, `popup.html`, `popup.js`, `style.css`, and the `images` folder) are located together in a single directory (e.g., `keio-library-search`).
2.  **Open Chrome Extensions**: ğŸŒ Open Google Chrome and navigate to `chrome://extensions` in your address bar.
3.  **Enable Developer Mode**: âš™ï¸ In the top-right corner of the Extensions page, turn on the **Developer mode** switch.
4.  **Load the Extension**:
    - ğŸ“¦ Click the **Load unpacked** button that appears on the top-left.
    - ğŸ“‚ In the file selection dialog, navigate to and select the folder where you saved the project files (the `keio-library-search` directory).
5.  **Done!**: âœ… The extension icon should now appear in your Chrome toolbar. You may need to click the puzzle piece icon and "pin" it to make it visible at all times.

## Usage ğŸ’¡

1.  Navigate to any product page on `www.amazon.co.jp`.
2.  Click the "Keio Library Searcher" icon in your toolbar.
3.  The search results from the Keio University Library will appear in the popup.

## Built With ğŸ› ï¸

- HTML5
- CSS3
- JavaScript (ES6+)
- Chrome Extension Manifest V3 APIs

---

## For Developers ğŸ§‘â€ğŸ’»

This section provides a brief overview of the codebase for those who want to understand, customize, or contribute to the project.

### File Structure ğŸ“‚

-   `manifest.json`: Defines the extension's properties, permissions, and behavior. It declares that `popup.html` should be used as the action popup.
-   `popup.html`: Provides the basic HTML structure for the popup window. It contains the `<iframe>` element where the library results are displayed and links to the necessary CSS and JavaScript files.
-   `popup.js`: This is the core logic of the extension. It runs every time the popup is opened.
-   `style.css`: Contains all the styling for the popup window.

### Core Logic (`popup.js`) ğŸ§ 

The script's execution flow is as follows:

1.  **Get Active Tab**: It uses `chrome.tabs.query()` to get information about the currently active tab.
2.  **Inject Content Script**: It checks if the active tab is an `amazon.co.jp` page. If so, it uses `chrome.scripting.executeScript()` to inject a function (`getPageTitle`) into the page.
3.  **Extract Title**: The injected `getPageTitle` function finds the product title by looking for `h1#productTitle` or `h1#title` and returns the text.
4.  **Clean Title**: Back in `popup.js`, the script receives the title and cleans it using a regular expression (`.replace(/\(.*?\)/g, '')`) to remove any text enclosed in parentheses.
5.  **Build and Set URL**: The cleaned title is URL-encoded via `encodeURIComponent()` and then inserted into the Keio Library search URL template. This final URL is then set as the `src` attribute of the `<iframe>` in `popup.html`, causing the results to be displayed.

### Customization ğŸ”§

-   **Change the Target Library**: To adapt this extension for a different library, you only need to change the `KEIO_SEARCH_URL_PREFIX` and `KEIO_SEARCH_URL_SUFFIX` constants at the top of `popup.js`.
-   **Update Title Selector**: If Amazon changes its page layout, the CSS selectors in the `getPageTitle` function within `popup.js` may need to be updated to correctly find the product title.
-   **Adjust Styling**: ğŸ¨ All visual aspects of the popup can be modified in `style.css`.